<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Connect to Google Docs</title>
</head>
<body>

<button onclick="openGooglePicker()">Connect to Google Docs</button>

<script>
    // Client ID and API key from the Google Developer Console
    var clientId = 'YOUR_CLIENT_ID';
    var apiKey = 'YOUR_API_KEY';

    // Authorization scopes required by the API
    var scopes = ['https://www.googleapis.com/auth/drive.file'];

    function handleClientLoad() {
        gapi.load('client:auth2', initClient);
    }

    function initClient() {
        gapi.client.init({
            apiKey: apiKey,
            clientId: clientId,
            discoveryDocs: ["https://www.googleapis.com/discovery/v1/apis/drive/v3/rest"],
            scope: scopes
        }).then(function () {
            // Listen for sign-in state changes.
            gapi.auth2.getAuthInstance().isSignedIn.listen(updateSigninStatus);
            // Handle the initial sign-in state.
            updateSigninStatus(gapi.auth2.getAuthInstance().isSignedIn.get());
        });
    }

    function updateSigninStatus(isSignedIn) {
        if (isSignedIn) {
            // User is signed in. You can perform your actions here.
            console.log('User is signed in');
        } else {
            // User is not signed in. You may want to sign in.
            console.log('User is not signed in');
        }
    }

    function openGooglePicker() {
        gapi.auth2.getAuthInstance().signIn().then(function () {
            var picker = new google.picker.PickerBuilder()
                .addView(google.picker.ViewId.DOCS)
                .setOAuthToken(gapi.auth2.getAuthInstance().currentUser.get().getAuthResponse().access_token)
                .setDeveloperKey(apiKey)
                .setCallback(pickerCallback)
                .build();
            picker.setVisible(true);
        });
    }

    function pickerCallback(data) {
        if (data.action == google.picker.Action.PICKED) {
            var doc = data.docs[0];
            alert('You picked: ' + doc.name);
            // Perform further actions with the picked document
        }
    }
</script>

<!-- Load the Google API client and picker API -->
<script src="https://apis.google.com/js/api.js?onload=handleClientLoad"></script>

</body>
</html>
